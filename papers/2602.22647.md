---
layout: default
title: "STATIC: Sparse Transition Matrix-Accelerated Trie Index for Constrained Decoding"
---

# STATIC: Vectorizing the Trie for Efficient Constrained Decoding

[arXiv:2602.22647](https://arxiv.org/abs/2602.22647) | [GitHub](https://github.com/youtube/static-constraint-decoding)

## 著者
Zhengyang Su, Isay Katsman, Yueqi Wang, Ruining He, Lukasz Heldt, Raghunandan Keshavan, Shao-Chuan Wang, Xinyang Yi, Mingyan Gao, Onkar Dalal, Lichan Hong, Ed Chi, Ningren Han (Google/YouTube)

## 概要
LLMベース生成的検索における制約付きデコーディングの効率化手法。Trie構造をCSR（Compressed Sparse Row）行列にフラット化し、TPU/GPU上で完全ベクトル化されたスパース行列演算に変換。

## 主要な貢献
- **STATIC**: ハードウェアアクセラレータ向けに最適化された制約付きデコーディング手法
- CPUベースTrie実装比で**948倍高速化**
- バイナリサーチベースライン比で**47-1033倍高速化**
- 推論時間への影響はわずか**0.25%**（ステップあたり0.033ms）

## 実運用での成果
- YouTube動画推薦プラットフォーム（**数十億ユーザー**規模）への本番デプロイ
- ビジネスロジックに基づく出力空間制約（コンテンツ鮮度、カテゴリ制限等）を実現
- 厳密な制約付き生成検索の初の本番規模デプロイ

## 技術詳細
- Prefix Tree → Static CSR Matrix変換による不規則なツリー走査の排除
- スパース行列演算によるTPU/GPUの並列処理能力の活用
- コールドスタート問題における性能改善も実証

## 選定理由
- **Google/YouTube**: トップ研究機関
- **実運用**: billion users規模の本番デプロイ
- **GitHub公開**: コード公開
