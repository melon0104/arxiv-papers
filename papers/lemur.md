---
layout: default
title: "LEMUR: Learned Multi-Vector Retrieval"
---

# LEMUR: Learned Multi-Vector Retrieval

arXiv:2601.21853
https://arxiv.org/abs/2601.21853

---

## 概要

ColBERTなどのlate interactionモデルはトークンごとに埋め込みを生成し、MaxSimで類似度を計算するため高精度だが、レイテンシが大きい課題があった。LEMURは2段階の問題変換でこれを解決する。

## 背景・課題

**マルチベクトル検索とは：**
- 従来のdense retrieval: クエリ・文書それぞれを1つのベクトルに圧縮
- マルチベクトル検索（ColBERT等）: トークンごとに1つの埋め込みを生成
- MaxSim: クエリの各トークンと文書の最も類似するトークンの類似度を合計

**課題：**
- 精度は高いが、ベクトル数が爆発的に増加
- 既存のANNS（近似最近傍探索）アルゴリズムが直接適用できない
- レイテンシが単一ベクトル検索の数十倍になることも

## 提案手法

LEMURは2つの問題変換を行う：

### Step 1: 教師あり学習問題への変換
- マルチベクトル間のMaxSim計算を、1層ニューラルネットワークの学習問題として定式化
- クエリのマルチベクトルを入力、文書との類似度を出力とするモデルを学習

### Step 2: 単一ベクトル検索への帰着
- 学習したNNの潜在空間において、文書を単一ベクトルとして表現
- これにより既存のANNSアルゴリズム（HNSW、IVF等）がそのまま使える

## 実験結果

- ColBERTv2埋め込みで評価
- 最新のマルチベクトルテキストモデルでも評価
- 視覚文書検索モデル（VisualBERT等）でも評価
- **従来のマルチベクトル検索手法より1桁（10倍）高速化**
- 精度の低下は最小限

## 意義・応用

- ColBERTの高精度を維持しつつ、実用的なレイテンシを実現
- 既存のベクトルDBインフラをそのまま活用可能
- マルチモーダル検索（画像+テキスト）にも適用可能

## 関連研究

- ColBERT / ColBERTv2
- PLAID（ColBERT高速化手法）
- 従来のANNSアルゴリズム（HNSW, IVF, ScaNN等）
